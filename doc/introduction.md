# git の紹介

- [1. git の概要](#1-git-の概要)
  - [ファイルをバックアップする機能](#ファイルをバックアップする機能)
  - [チームでファイルを共有する機能](#チームでファイルを共有する機能)
  - [まとめ](#まとめ)
- [コミット](#コミット)
  - [1.1. コミットの作成](#11-コミットの作成)
  - [1.2. コミットの復元](#12-コミットの復元)
  - [1.3. コミットのマージ](#13-コミットのマージ)
- [2. git の機能](#2-git-の機能)
  - [2.1. リポジトリ](#21-リポジトリ)
  - [2.2. ワークツリー・インデックス](#22-ワークツリーインデックス)
  - [2.3. ブランチ](#23-ブランチ)
  - [2.4. ローカルリポジトリ・リモートリポジトリ](#24-ローカルリポジトリリモートリポジトリ)

## 1. git の概要

git は、ソースコードや変更履歴を管理するためのバージョン管理システムです。

git には、大きく以下の2つの機能があります。
- ファイルをバックアップする機能
- チームでファイルを共有する機能


### ファイルをバックアップする機能

ファイルを修正して誤った変更をしてしまったとき、編集前の状態に戻したいことがあります。  
このとき、ファイルのバックアップを作っていれば、ファイルを編集前の状態に戻せます。  
また、現在のファイルとバックアップを比較すれば、ファイルの変更箇所を知ることができます。  
ファイルのバックアップに名前と作成日があれば、変更の一覧を日付順で見ることもできます。  

### チームでファイルを共有する機能
 
ファイルをチームのメンバーに共有するとき、別の人が同じファイルを変更して別バージョンができてしまった、ということがあります。  
また、共有フォルダを使っている場合、二人で同時に編集してしまったために先に編集した人の内容が消えてしまった、ということもあります。  
git では、ファイルの変更箇所が異なる場合、変更をマージすることができます。  
そして、ファイルの変更箇所が重なる場合、git が変更の重複を警告してくれます。  

### まとめ

まとめると、git には以下の機能があります。

- ファイルをバックアップする機能
  - 過去のファイルを復元する
  - ファイルの変更箇所を知る
  - 変更の一覧を日付順で見る
- チームでファイルを共有する機能
  - ファイルの変更箇所が異なる場合、変更をマージする
  - ファイルの変更箇所が重なる場合、変更の重複を警告する

上記の機能は一例に過ぎず、git には他にも様々な便利機能があります。

## コミット

git のコミットとは「ファイルをバックアップする機能」における、まさにバックアップそのものです。  
もう少し正確にいうと、「ある瞬間のディレクトリ全体のバックアップ」です。
ソースコードを修正する場合は複数のファイルにまたがることが多いため、ディレクトリ全体のバックアップを持っておけば修正箇所もわかりやすいのです。

### 1.1. コミットの作成

コミットの作成とは、ある瞬間のディレクトリ全体を1つのコミットとして保存することです。  
例えば、ファイルを修正したいが古いものをバックアップにとっておきたいことがあります。  
ディレクトリ全体をコミットとして保存しておくことで、過去のコミットを復元したり、コミットのマージを行うことができます。  
また、コミット作成時に直前のコミットを親コミットして記録するため、どのタイミングで変更があったかを知ることができます。  


![commit-create](image/introducion/commit-create.drawio.svg)

### 1.2. コミットの復元

コミットの復元とは、ファイルやディレクトリを特定のコミットの状態に復元することです。  
例えば、変更前のファイルの内容を確認したいことがあります。  
その際に、過去のコミットに含まれるファイルとディレクトリの状態を復元することができます。  
コミットの状態をそのまま復元するため、作業ディレクトリに存在しないファイルは作成され、存在するファイルはコミットの内容で上書きされます。また、コミットに存在しないファイルは作業ディレクトリから削除されます。

![commit-restore](image/introducion/commit-restore.drawio.svg)

### 1.3. コミットのマージ

コミットのマージとは、複数のコミットを元にその内容をマージした1つのコミット作成することです。  
例えば、他人のファイルの変更と自分のファイルの変更をマージしたいことがあります。  
その際に、それぞれの変更をコミットとして作成し、マージすることができます。  
また、マージ元の2つのコミットを親コミットとして記録するため、どのコミットをマージしたのかを知ることができるようになっています。  

![commit-merge](image/introducion/commit-merge.drawio.svg)

## 2. git の機能

### 2.1. リポジトリ

リポジトリは、git のデータの保管庫です。  
コミット・ブランチなどの git のデータを保持しています。(ブランチについては後述)  
特定のディレクトリをリポジトリにすることによって、そのディレクトリ配下でコミットの作成・マージ・復元を行うことができるようになります。  

![repository](image/introducion/repository.drawio.svg)

### 2.2. ワークツリー・インデックス

ワークツリーは、コミットの復元先のディレクトリ全体です。  
デフォルトでは、リポジトリとして指定したディレクトリ全体がワークツリーとなります。  
コミットが変わる際、変わった先のコミットのファイルやディレクトリがワークツリーに復元されます。  

![worktree](image/introducion/worktree.drawio.svg)

インデックスは、ファイルの変更が一時保存される場所です。  
ワークツリーと異なり実際のディレクトリ上には見えず裏で管理されています。  
コミットが変わる際、変わった先のコミットのファイルやディレクトリがインデックスに復元されます。  

![index](image/introducion/index.drawio.svg)

ワークツリーとインデックスの活用方法の1つとして、「コミットに保存するファイルの選別」があります。  
実際の開発では、複数の作業を一度に行って後からコミットを作成したいことがあります。  
まず、ワークツリー上の1作業分のファイルの変更をインデックスに登録します。  
そして、インデックスをコミットとして保存することで、作業ごとにファイルを選別してコミットを作成することができるのです。  

![index-commit](image/introducion/index-commit.drawio.svg)

また、ワークツリー上のファイルをインデックスに登録することを **「ステージング」** と呼びます。

### 2.3. ブランチ

ブランチは、開発の目印です。  
ブランチは特定のコミットを指し示し、開発者はブランチ名からどのような機能を開発しているかを判別することができます。  
またコミットの作成時に、現在のブランチは作成されたコミットへと移動するため、ブランチは最新の開発コミットを指し示すことができます。  

![branch](image/introducion/branch.drawio.svg)

ワークツリー・インデックスの状態を特定のコミットに変更したい場合は、ブランチの切り替えを行います。  
現在のブランチを切り替えることで、そのブランチの指すコミットがワークツリー・インデックス上に復元されます。  
コミットの復元は、ブランチの切り替えによって行うことが多いです。  

![branch-switch](image/introducion/branch-switch.drawio.svg)


### 2.4. ローカルリポジトリ・リモートリポジトリ

ローカルリポジトリは、手元で作業するためのリポジトリです。  
リモートリポジトリは、ローカルリポジトリとは別の場所に配置されたリポジトリです。  
ローカルリポジトリでリモートリポジトリを設定することで、2つのリポジトリ間で git データ(コミット・ブランチなど)を共有することができます。  

![remote-download](image/introducion/remote-download.drawio.svg)

例えば、チームで各々のローカルリポジトリに共有のリモートリポジトリを設定することで、チーム間でコミットやブランチを共有することができます。  

![remote-upload](image/introducion/remote-upload.drawio.svg)